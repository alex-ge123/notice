server:
  port: 8007

spring:
  application:
    name: virsical-notice
  profiles:
    active: testcase
  flyway:
    # 是否启用flyway
    enabled: true
    # 升级脚本位置，可以配置多个，英文逗号分隔
    locations: classpath:db/migration
    # 检测迁移脚本的路径是否存在，如不存在，则抛出异常
    check-location: true
    # 在迁移时，是否校验已迁移过的脚本，是否有改动
    validate-on-migrate: true
    # 新的环境中数据库中有数据，且没有flyway_schema_history表时，是否执行迁移操作（默认为false）
    # false:在启动时会报错，并停止迁移; true:则生成history表并完成所有的迁移，要根据实际情况设置;
    # 如果数据库是新部署，请配置false
    baseline-on-migrate: false
    # 升级脚本基础版本，与 baseline-on-migrate: true 搭配使用（默认为1）
    baseline-version: 1
    # 基础版本执行时描述， 默认为<<Flyway Baseline>>
    baseline-description: <<Flyway Baseline>>
    # 占位符是否要被替换，默认true.
    placeholder-replacementplaceholders: false
    # 设置每个占位符的前缀，默认${.
    placeholder-prefix: '#{{'
    # 设置每个占位符的后缀，默认}.
    placeholder-suffix: '}}'
  # 配置中心
  cloud:
    config:
      enabled: false
  jpa:
    show-sql: true
    hibernate:
      naming:
        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
      ddl-auto: update
    database-platform: org.hibernate.dialect.MySQL5Dialect
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL5Dialect
        current_session_context_class: org.springframework.orm.hibernate5.SpringSessionContext
  datasource:
    url: jdbc:mysql://192.168.203.20:20000/virsical_notice?useUnicode=true&characterEncoding=utf8&autoReconnect=true&failOverReadOnly=false&useSSL=false&serverTimezone=Asia/Shanghai
    username: wafer
    password: wafer
    driver-class-name: com.mysql.cj.jdbc.Driver
    type: com.alibaba.druid.pool.DruidDataSource
  redis:
    host: 0.0.0.0
    port: 7007
  rabbitmq:
    host: 192.168.203.141
    port: 5672
    virtual-host: /testcase-notice
    username: testcase-notice
    password: testcase-notice

# 注册中心配置
eureka:
  client:
    enabled: false

## spring security 配置
security:
  oauth2:
    client:
      client-id: ENC(KmOp5EIyjX0n6hoYE0jMSIDq12xwlmcs)
      client-secret: ENC(KmOp5EIyjX0n6hoYE0jMSIDq12xwlmcs)
      scope: server
      ignore-urls:
        - '/actuator/**'
        - '/v2/api-docs'
        - '/sms/sendSms'
        - '/sms/sendCaptcha'
        - '/sms/checkCaptcha'
        - '/mail/sendMail'
    resource:
      loadBalanced: true
      # token解码的URI
      token-info-uri: http://virsical-auth/oauth/check_token
      
# 加解密根密码
jasypt:
  encryptor:
    password: wafer
aes:
  # 前端密码密钥，必须16位
  key: 'XDH206VF30Nf9q7t'

# 系统参数配置
system:
  # 云服务开关
  cloud-service: false
  # 手机号认证开关
  phone-auth: true
  # 邮箱认证开关
  email-auth: true
  # 默认域配置（开启配置对应域名，不开启配置null）
  default-domain: baidu.com

# 暴露监控端点
management:
  endpoints:
    web:
      exposure:
        include: '*'
  endpoint:
    health:
      show-details: ALWAYS
# feign 配置
feign:
  hystrix:
    enabled: true
  okhttp:
    enabled: true
    # 最多连接数，默认200
    max-connections: 800
    # 每个route最多连接数，默认50
    max-connections-per-route: 200
  httpclient:
    enabled: false
  client:
    config:
      default:
        connectTimeout: 20000
        readTimeout: 20000
  compression:
    request:
      enabled: true
    response:
      enabled: true
# hystrix If you need to use ThreadLocal bound variables in your RequestInterceptor`s
# you will need to either set the thread isolation strategy for Hystrix to `SEMAPHORE or disable Hystrix in Feign.
hystrix:
  command:
    default:
      execution:
        isolation:
          strategy: SEMAPHORE
          thread:
            timeoutInMilliseconds:  10000
          semaphore:
            maxConcurrentRequests: 1000
      circuitBreaker:
        sleepWindowInMilliseconds:  5000
  shareSecurityContext: true

#请求处理的超时时间
ribbon:
  # 请求处理时间
  ReadTimeout: 5000
  # 获取连接的超时时间
  ConnectTimeout: 3000

#swagger公共信息
swagger:
  title: Swagger API
  description: 微服务公共基础服务
  version: 3.0
  license: Powered By Virsical
  contact:
    name: admin
    email: tandongkui@wafersystems.com
  authorization:
    name: Virsical OAuth
    auth-regex: ^.*$
    authorization-scope-list:
      - scope: server
        description: server all
    token-url-list:
      - http://localhost:8000/virsical-auth/oauth/token

logging:
  file: logs/${spring.application.name}/debug.log
  level:
    root: info

sms:
  captcha:
    # 验证码长度
    length: 6
    # 验证码有效期，单位秒
    timeout: 300

#短信邮件重复发送拦截
intercept:
  # 短信拦截是否开启
  smsEnabled: true
  # 短信拦截时间范围（多少分钟内）
  smsTimeHorizon: 3
  # 邮件拦截是否开启
  mailEnabled: true
  # 邮件拦截时间范围（多少分钟内）
  mailTimeHorizon: 3

# 短信数量查询url
sms-num-search-url: https://work.virsical.cn/sms/search/balance